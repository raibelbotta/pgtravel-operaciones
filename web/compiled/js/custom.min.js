;App=typeof App!=='undefined'?App:{};+(App.Main=function(t){var o=function(){t('[title]:not(.sidebar-footer *, .cke *)').tooltipster({theme:'tooltipster-shadow'});t('body').on('draw.dt','table',function(){t(this).find('[title]').tooltipster({theme:'tooltipster-shadow'})})},e=function(){if(t('input.flat')[0]){t('input.flat').iCheck({checkboxClass:'icheckbox_flat-green',radioClass:'iradio_flat-green'})}},n=function(){t('#modalPassword button[type=button]:last').hide().on('click',function(){t('#modalPassword form').submit()});t.validator.addMethod('validpassword',function(t,o){return this.optional(o)||(/[A-Z]/.test(t)&&/[0-9]/.test(t)&&/[a-z]/.test(t)&&t.length>7)},Translator.trans('Password strength is too low (include letters, capital letters and digits)'));t('#linkChangePassword').on('click',function(o){o.preventDefault();t('#modalPassword').modal().on('hide.bs.modal',function(){t(this).find('form').remove()});t('#modalPassword .modal-body').empty().load(Routing.generate('app_user_changepassword'),function(){t('#modalPassword form').validate({messages:{'form[current_password]':{remote:Translator.trans('Wrong password')}},rules:{'form[current_password]':{remote:{url:Routing.generate('app_user_checkpassword'),type:'post',data:{password:function(){return t('#form_current_password').val()}}}},'form[plainPassword][first]':'validpassword','form[plainPassword][second]':{equalTo:'#form_plainPassword_first'}},errorPlacement:function(o,e){if(!e.data('tooltipster-ns')){e.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};e.tooltipster('update',t(o).text());e.tooltipster('show')},success:function(o,e){t(e).tooltipster('hide')},submitHandler:function(){t('#modalPassword form').ajaxSubmit({dataType:'json',beforeSubmit:function(){t('#modalPassword button[type=button]:last').hide()},success:function(o){if(o.result=='success'){t('#modalPassword .modal-body').empty().append(t('<div/>').addClass('alert alert-success').text(Translator.trans('Password changed successfully!')))}
else{t('#modalPassword .modal-body').empty().append(t('<div/>').addClass('alert alert-warning').text(Translator.trans('Password coold not be changed.')))};t('#modalPassword button[type=button]:first').text('Close')}})}});t('#modalPassword button[type=button]').show()})})},a=function(t){swal({title:Translator.trans('Notification'),text:t})};return{init:function(){o();e();n()},alert:a}}(jQuery));+(App.Forms=function(t){var o=function(){var o=function(o){o.preventDefault();t(this).closest('.item').fadeOut(function(){var o=t(this).closest('.collection');t(this).remove();o.trigger('item-removed.app')})},e=function(o){var e=t(this).parent().parent().find('.collection:first'),s=e.data('prototype'),n=e.data('index');if(e.length==0||typeof s=='undefined'||typeof n=='undefined'){return};var a=t(s.replace(/__name__/g,n));e.data('index',n+1);e.append(a);t(a.find('input:text:visible, select:visible, textarea:visible')[0]).focus();e.trigger('item-added.app',{index:n,item:a})};t('body').on('click','.btn-add-item',e);t('body').on('click','.btn-remove-item',o);t('.collection').each(function(){var o=t(this);o.data('index',o.find('>.item').length)})},e=function(o,e){t(o).intlTelInput(t.extend({},{allowExtensions:!0,autoFormat:!1,autoHideDialCode:!0,autoPlaceholder:!1,defaultCountry:'auto',geoIpLookup:function(o){t.get('http://ipinfo.io',function(){},'jsonp').always(function(t){var e=(t&&t.country)?t.country:'';o(e)})},nationalMode:!1,numberType:'MOBILE',preferredCountries:['us','ca','cu'],utilsScript:phone_util_script_url},e))};return{init:function(){o()},initTelephoneControl:e}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Bookings=typeof App.Bookings!=='undefined'?App.Bookings:{};+(App.Bookings.Form=function(e){'use strict';var a,t=function(e){return isNaN(parseFloat(e))?0:parseFloat(e)},n=function(){e('input:radio[name="offer_form[clientType]"]').iCheck({radioClass:'iradio_flat-green'});e('input:radio[name="offer_form[clientType]"]').on('ifClicked',function(){var t=e(this).val();if(t==='direct'){e('.block-clienttype.block-clienttype-direct').show();e('.block-clienttype:not(.block-clienttype-direct)').find('input:text, select').each(function(){if(e(this).data('tooltipster-ns')){e(this).tooltipster('hide')}});e('.block-clienttype:not(.block-clienttype-direct)').hide()}
else if(t==='registered'){e('.block-clienttype.block-clienttype-registered').show();e('.block-clienttype:not(.block-clienttype-registered)').find('input:text, select').each(function(){if(e(this).data('tooltipster-ns')){e(this).tooltipster('hide')}});e('.block-clienttype:not(.block-clienttype-registered)').hide()}});e('#offer_form_client').select2({width:'100%'});e('#offer_form_client').on('change',function(){e('#offer_form_notificationContact').empty();var t=e(this).val();e.getJSON(Routing.generate('app_offers_getclientcontacts')+'?client='+t,function(t){e('#offer_form_notificationContact').append(e('<option value=""></option>'));e.each(t.elements,function(t,a){e('#offer_form_notificationContact').append(e('<option value="'+a.id+'">'+a.text+'</option>'))})})});App.Forms.initTelephoneControl(e('#offer_form_directClientMobilePhone'));a.on('click','.btn-search-service',function(){var a=e(this).closest('.item');e('#searchServiceModal').remove();var t=e('<div id="searchServiceModal" class="modal fade in" data-backdrop="static"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">'+Translator.trans('Search service')+'</h4></div><div class="modal-body"></div><div class="modal-footer"><button type="button" data-dismiss="modal" class="btn btn-default">'+Translator.trans('Close')+'</button></div></div></div></div>').appendTo(e('body'));t.data('item',a).modal();t.find('.modal-body').empty().append(e('<p>'+Translator.trans('Loading data...')+'</p>')).load(Routing.generate('app_offers_searchservice'),s)});a.on('change','.item.item-service select[name$="[model]"]',function(){var t=e(this).closest('.item'),a=this.options[this.selectedIndex],n=e(a).data('options')?e(a).data('options').split(' '):[];e.each(n,function(e){var a=n[e];if(a.substr(0,1)==='-'){t.find('.visible-'+a.substr(1)).hide()}
else{t.find('.visible-'+(a.substr(0,1)=='+'?a.substr(1):a)).show()}});t.find('input[name$="[cost]"]').trigger('change')});e('.item.item-service select[name$="[model]"]').trigger('change');+(function(){var i=function(a){var n=e(a),i=n.find('input[name$="[nights]"]'),r=n.find('input[name$="[pax]"]'),o=n.find('input[name$="[cost]"]'),s=n.find('input[name$="[totalPrice]"]'),l=i.is(':visible')?t(i.val()):0,f=r.is(':visible')?t(r.val()):0,c=l*t(o.val())+f*t(o.val());s.val(c.toFixed(2))},n=function(){var a=new Number(0);e('.item-service input[name$="[totalPrice]"]').each(function(){a+=t(e(this).val())});e('#offer_form_totalSuppliers').val(a.toFixed(2)).trigger('change')};e('#offer_form_services').on('change','input[name$="[nights]"], input[name$="[pax]"], input[name$="[cost]"]',function(){i(e(this).closest('.item-service'))});e('#offer_form_services').on('change','.item-service input[name$="[totalPrice]"]',function(){n()});e('.item-administrative-charge').on('change','input',function(){if(!e(this).is('[name$="[pax]"], [name$="[multiplier]"], [name$="[price]"]')){return};var a=e(this).closest('.item'),n=t(a.find('input[name$="[multiplier]"]').val())*t(a.find('input[name$="[pax]"]').val())*t(a.find('input[name$="[price]"]').val());e(this).closest('.item').find('input[name$="[total]"]').val(n.toFixed(2)).trigger('change')});var a=function(){var n=e('#offer_form_totalExpenses'),i=e('.item-administrative-charge input[name$="[total]"]'),a=new Number(0);i.each(function(){a+=t(e(this).val())});n.val(a.toFixed(2)).trigger('change')};e('.item-administrative-charge').on('change','input[name$="[total]"]',function(){a()});e('#offer_form_totalSuppliers, #offer_form_totalExpenses, #offer_form_percentApplied_percent, #offer_form_percentApplied_plus').on('change',function(){var n=t(e('#offer_form_totalSuppliers').val()),i=t(e('#offer_form_totalExpenses').val()),r=e('#offer_form_percentApplied_percent').val(),o,a;if(r==='plus'){a=t(e('#offer_form_percentApplied_plus').val())}
else{a=(n+i)/((100-t(r))/100)};o=n+i+a;e('#offer_form_grandTotal').val(o.toFixed(2));e('#offer_form_totalRevenue').val(a.toFixed(2))});e('#offer_form_totalSuppliers').trigger('change');e('#offer_form_percentApplied_percent').on('change',function(){if(e(this).val()!=='plus'){e('#offer_form_percentApplied_plus').val(0).attr('readonly','readonly')}
else{e('#offer_form_percentApplied_plus').removeAttr('readonly')}});n();a()}())},i=function(){var t=e('#offer_form_revenuePaxLines'),a=e('#btnAddItemoffer_form_revenuePaxLines');t.data('index',t.find('.item').length);a.on('click',function(){t.find('tr:not(.item)').remove();var n=t.data('prototype'),a=window.parseInt(t.data('index')),i=e(n.replace(/__name__/g,a));t.append(i).data('index',a+1)});t.on('click','.btn-delete-item',function(){var a=t.find('tr.item');if(a.length===1){t.append(e('<tr><td>No elements</td></tr>'))};e(this).closest('.item').fadeOut(function(){e(this).remove()})})},r=function(){var n=function(t,a){var n=t.find('input[name$="[nights]"]'),i=t.find('input.datepicker'),o=e.now();if(n.data('ajax')){n.data('ajax').abort()};if(e(i[0]).val()==''){return};if(e(a).is('.datepicker')){if(e(i[1]).val()==''){n.val('');return};var r=e.ajax(Routing.generate('app_offers_getnights')+'?id='+o,{data:{from:e(i[0]).val(),to:e(i[1]).val()},dataType:'json',method:'POST',success:function(e){n.val(e.nights);n.removeData('ajax')}})}
else{if(e(a).val()==''){e(i[1]).val('');return};var r=e.ajax(Routing.generate('app_offers_getnights')+'?id='+o,{data:{from:e(i[0]).val(),nights:n.val()},dataType:'json',method:'POST',success:function(t){e(i[1]).val(t.to);n.removeData('ajax')}})};n.data('ajax',r)},r=function(t){var a=e(t).find('input.datepicker'),i={format:'DD/MM/YYYY HH:mm',showClear:!0,showTodayButton:!0};e(a[0]).parent().datetimepicker(i);e(a[1]).parent().datetimepicker(e.extend({},i,{useCurrent:!1}));e(a[0]).parent().on('dp.change',function(i){e(a[1]).parent().data('DateTimePicker').minDate(i.date);n(e(t),a[0])});e(a[1]).parent().on('dp.change',function(i){e(a[0]).parent().data('DateTimePicker').maxDate(i.date);n(e(t),a[1])})},o=function(t){e(t).find('select[name$="[origin]"], select[name$="[destination]"]').select2({minimunInputLength:1,width:'100%',ajax:{url:Routing.generate('app_offers_getplaces'),dataType:'json',delay:250,method:'GET',data:function(e){return{q:e.term,page:e.page}},processResults:function(e){var t=e.data;t.unshift({id:0,text:''});return{results:t}}}})},s=function(t){e(t).find('select[name$="[supplier]"]').select2({width:'100%'})};e('.item.item-service').each(function(){r(this);o(this);s(this)});a.on('change','.item-service input[name$="[nights]"]',function(){n(e(this).closest('.item'),this)});a.on('click','.btn-add-item',function(t){var f=e(this);if(typeof f.data('collection')==='undefined'){return};if(f.is('a')){t.preventDefault()};var n=e(f.data('collection')),d=n.data('index'),p=n.data('prototype'),l=n.data('counter')?e(n.data('counter')):null,a=e(p.replace(/__name__/g,d));n.data('index',d+1);if(l){l.val(parseInt(l.val(),10)+1)};n.append(a);if(a.is('.item-service')){if(n.find('.item-service').length>1){var c=a.prev();for(var i=0;i<2;i++){if(c.find('.datepicker:eq('+i+')').val()!==''){a.find('.datepicker:eq('+i+')').val(c.find('.datepicker:eq('+i+')').val())}}};a.find('select[name$="[model]"]').trigger('change');r(a);o(a);s(a)};a.find('input:text:first').focus();if(n.closest('div.x_panel').find('h2').data('tooltipster-ns')){n.closest('div.x_panel').find('h2').tooltipster('hide')};e('body').animate({scrollTop:a.offset().top},500);a.find('.btn-search-service').trigger('click')});a.on('click','.btn-remove-item',function(t){var a=e(this),n=a.closest('.item');if(a.is('a')){t.preventDefault()};swal({title:Translator.trans('Confirm operation'),text:Translator.trans('The service will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(t){if(t){n.fadeOut(function(){var a=e(this).closest('.collection'),t=a.data('counter')?e(a.data('counter')):null;e(this).remove();if(t){t.val(t.val()-1)}})}})});i();a.on('change','input[name^="offer_form[revenuePaxLines]["][name$="][price]"], input[name^="offer_form[revenuePaxLines]["][name$="][pax]"]',function(){var a=e(this).closest('.item'),n=a.find('input[name$="][price]"]'),i=a.find('input[name$="][pax]"]'),r=a.find('input[name$="][total]"]');r.val(t(t(n.val())*t(i.val())))})},o=function(){e.validator.addClassRules('endatrequired',{required:{depends:function(t){var a=e(t).closest('.item'),n=a.find('select[name$="[model]"]').val();return n!='transport'}}});e.validator.addMethod('totalizedrevenuelines',function(t){var n=window.parseFloat(t),a=0,i=e('#offer_form_revenuePaxLines');i.find('input[name^="offer_form[revenuePaxLines]["][name$="][total]"]').each(function(){a+=window.parseFloat(e(this).val())});return a===n},'Error totalizing revenue lines');e('#reservation').validate({errorPlacement:function(t,a){if(a.is(':hidden')){a=a.closest(':visible')};if(!a.data('tooltipster-ns')){a.tooltipster({'trigger':'custom','onlyOne':!1,'position':'bottom-left','positionTracker':!0})};a.tooltipster('update',e(t).text());a.tooltipster('show')},ignore:':hidden:not(input[name="servicesCounter"])',messages:{'servicesCounter':{'min':Translator.trans('Add a service at least')}},rules:{'servicesCounter':{'min':1},'offer_form[directClientFullName]':{'required':{'depends':function(){return e('#offer_form_clientType_1').prop('checked')===!0}}},'offer_form[client]':{'required':{'depends':function(){return e('#offer_form_clientType_0').prop('checked')===!0}}},'offer_form[percentApplied][plus]':'number'},success:function(t,a){var n=e(a);if(n.is(':hidden')){n=n.closest(':visible')};n.tooltipster('hide')}})},s=function(){var t=e('#searchServiceModal');t.on('preDraw.dt','table',function(){e(this).parent().block({'message':Translator.trans('Loading services...')})}).on('draw.dt','table',function(){e(this).parent().unblock()});var a={initDatepickers:function(t,a,n){var i={showClear:!0,showTodayButton:!0};t.datetimepicker(e.extend({},i,{format:t.data('format')?t.data('format'):'DD/MM/YYYY'}));a.datetimepicker(e.extend({},i,{format:a.data('format')?a.data('format'):'DD/MM/YYYY',useCurrent:!1}));t.on('dp.change',function(e){a.data('DateTimePicker').minDate(e.date);n()});a.on('dp.change',function(e){t.data('DateTimePicker').maxDate(e.date);n()})},translateResults:function(t,a){var n=function(e){return t.find('[name$="['+e+']"]')};n('model').val(a.model).trigger('change');e.each(a,function(e,t){n(e).val(t)})}};var n=function(){var n=t.find('#tab-hotel'),r=n.find('table.table-results');r.dataTable({serverSide:!0,ajax:{url:Routing.generate('app_offers_gethotelprices'),data:function(t){var a=[];e.each(e('form#filter-hotel').serializeArray(),function(e,t){if(/\[\]$/.test(t['name'])){var n=t['name'].replace(/\[\]$/,'');if(!a[n]){a[n]=[]};a[n].push(t['value'])}
else{a[t['name']]=t['value']}});return e.extend(!0,t,a)},method:'POST'},columns:[{name:'hotel',title:Translator.trans('Hotel')},{name:'room',title:Translator.trans('Room')},{name:'seasson',title:Translator.trans('Season')},{name:'plan',title:Translator.trans('Plan')},{name:'pax',title:Translator.trans('Pax')},{name:'price',title:Translator.trans('Price')},{name:'total',title:Translator.trans('Total')},{sortable:!1,searchable:!1,width:'40px'}]});var i=function(){r.dataTable().api().draw()};r.on('click','button.btn-select-service',function(){var i=e(this).data('service');t.modal('hide');var r=t.data('item');a.translateResults(r,{'model':'hotel','startAt':n.find('input.datepicker:first').val()+' 12:00','endAt':n.find('input.datepicker:last').val()+' 16:00','name':i.serviceName,'facilityName':i.hotel,'nights':i.nights,'supplier':i.supplier.id,'pax':i.pax,'supplierNotes':i.plan,'cost':i.cost,'totalPrice':i.totalPrice});r.find('select[name$="[supplier]"]').trigger('change.select2');r.find('input[name$="[totalPrice]"]').trigger('change')});n.find('form .date:first').on('dp.change',function(e){var t=e.date?e.date.clone():null,a=n.find('form input.datepicker:last').val()?moment(n.find('form input.datepicker:last').val(),'DD/MM/YYYY'):null;if(!t||!a){n.find('form input[name="hotel_filter_form[nights]"]').val('')}
else{var i=a.startOf('day').diff(t.startOf('day'),'days');n.find('form input[name="hotel_filter_form[nights]"]').val(i)}});n.find('form .date:last').on('dp.change',function(e){var t=n.find('form input.datepicker:first').val()?moment(n.find('form input.datepicker:first').val(),'DD/MM/YYYY'):null,a=e.date?e.date.clone():null;if(!t||!a){n.find('form input[name="hotel_filter_form[nights]"]').val('')}
else{var i=a.startOf('day').diff(t.startOf('day'),'days');n.find('form input[name="hotel_filter_form[nights]"]').val(i)}});n.find('input[name="hotel_filter_form[nights]"]').on('change',function(){var t=n.find('form input.datepicker:first').val()?moment(n.find('form input.datepicker:first').val(),'DD/MM/YYYY'):null,a=e(this).val();if(''===a){n.find('form input.datepicker:last').val('')}
else{t.add(a,'days');n.find('form input.datepicker:last').val(t.format('DD/MM/YYYY'))};i()});a.initDatepickers(n.find('input.datepicker:first').parent(),n.find('input.datepicker:last').parent(),i);n.find('select').on('change',function(){i()});t.find('a[role=tab][aria-controls=tab-hotel]').on('shown.bs.tab',function(){i()})},i=function(){var n=t.find('#tab-private-house'),r=n.find('table.table-results');r.dataTable({serverSide:!0,ajax:{url:Routing.generate('app_offers_getprivatehouseprices'),data:function(t){var a=[];e.each(e('form#filter-private-house').serializeArray(),function(e,t){a[t['name']]=t['value']});return e.extend(!0,t,a)},method:'POST'},columns:[{name:'supplier',title:Translator.trans('Supplier')},{name:'room',title:Translator.trans('Room')},{name:'plan',title:Translator.trans('Plan')},{name:'price',title:Translator.trans('Price')},{name:'total',title:Translator.trans('Total'),sortable:!1},{sortable:!1,searchable:!1,width:'40px'}]});var i=function(){r.dataTable().api().draw()};n.find('form .date:first').on('dp.change',function(e){var t=e.date?e.date.clone():null,a=n.find('form input.datepicker:last').val()?moment(n.find('form input.datepicker:last').val(),'DD/MM/YYYY'):null;if(!t||!a){n.find('form input[name$="[nights]"]').val('')}
else{var i=a.startOf('day').diff(t.startOf('day'),'days');n.find('form input[name$="[nights]"]').val(i)}});n.find('form .date:last').on('dp.change',function(e){var t=n.find('form input.datepicker:first').val()?moment(n.find('form input.datepicker:first').val(),'DD/MM/YYYY'):null,a=e.date?e.date.clone():null;if(!t||!a){n.find('form input[name$="[nights]"]').val('')}
else{var i=a.startOf('day').diff(t.startOf('day'),'days');n.find('form input[name$="[nights]"]').val(i)}});n.find('input[name$="[nights]"]').on('change',function(){var t=n.find('form input.datepicker:first').val()?moment(n.find('form input.datepicker:first').val(),'DD/MM/YYYY'):null,a=e(this).val();if(''===a){n.find('form input.datepicker:last').val('')}
else{t.add(a,'days');n.find('form input.datepicker:last').val(t.format('DD/MM/YYYY'))};i()});a.initDatepickers(n.find('input.datepicker:first').parent(),n.find('input.datepicker:last').parent(),i);n.find('form#filter-private-house').find('input:not(.datepicker, [name$="[nights]"]), select').on('change',function(){i()});t.find('a[role=tab][aria-controls=tab-private-house]').on('shown.bs.tab',function(){i()});n.on('click','button.btn-select-service',function(){var i=e(this).data('service'),r=t.data('item');a.translateResults(r,{'model':'private-house','startAt':n.find('input.datepicker:first').val()+' 12:00','endAt':n.find('input.datepicker:last').val()+' 16:00','name':i.service,'supplier':i.supplier.id,'facilityName':i.supplier.name,'nights':i.nights,'pax':1,'cost':i.cost,'totalPrice':i.totalPrice,'supplierNotes':i.supplierNotes});r.find('[name$="[supplier]"]').trigger('change.select2');r.find('[name$="[totalPrice]"]').trigger('change');t.modal('hide')})},r=function(){var n=t.find('#tab-car-rental'),r=n.find('table.table-results');r.dataTable({serverSide:!0,ajax:{url:Routing.generate('app_offers_getcarrentalprices'),data:function(t){return e.extend({},t,{filter:{from:n.find('input:text.datepicker:first').val(),to:n.find('input:text.datepicker:last').val(),quantity:n.find('select[name="quantity"]').val(),categoy:n.find('input[name="category"]').val()}})},method:'POST'},columns:[{name:'supplier',title:Translator.trans('Supplier')},{name:'category',title:Translator.trans('Category')},{name:'cost',title:Translator.trans('Cost'),searchable:!1},{name:'price',title:Translator.trans('Price'),searchable:!1},{searchable:!1,sortable:!1,width:'40px'}]});var i=function(){r.dataTable().api().draw()};a.initDatepickers(n.find('input.datepicker:first').parent(),n.find('input.datepicker:last').parent(),i);n.find('form#filter-car-rental').find('input:not(.datepicker), select').on('change',function(){i()});t.find('a[role=tab][aria-controls=tab-car-rental]').on('shown.bs.tab',function(){i()});n.on('click','button.btn-select-service',function(){var i=e(this).data('service'),r=t.data('item');a.translateResults(r,{'model':'car-rental','startAt':n.find('input.datepicker:first').val()+' 08:00','endAt':n.find('input.datepicker:last').val()+' 08:00','name':i.name,'supplier':i.supplier.id,'rentCar':i.carType,'cost':i.cost,'totalPrice':i.totalPrice});r.find('[name$="[supplier]"]').trigger('change.select2');r.find('[name$="[totalPrice]"]').trigger('change');t.modal('hide')})},o=function(){var n=t.find('#tab-transport'),r=function(){n.find('.table-results').dataTable({serverSide:!0,aoColumns:[{name:'service','title':Translator.trans('Service')},{name:'supplier','title':Translator.trans('Supplier')},{name:'price','title':Translator.trans('Price')},{name:'total','title':Translator.trans('Total')},{'sortable':!1,searchable:!1,width:'40px'}],ajax:{url:Routing.generate('app_offers_gettransportprices'),method:'POST',data:function(t){return e.extend({},t,{filter:{'from':n.find('input:text.datepicker:first').val(),'to':n.find('input:text.datepicker:last').val(),'quantity':n.find('select[name="quantity"]').val(),'addhalfday':n.find('input:checkbox').prop('checked')==!0?1:0}})}}})},i=function(){if(n.find('.table-results tbody').length>0){n.find('table.table-results').dataTable().api().draw()}
else{r()}};n.find('form input:checkbox').iCheck({checkboxClass:'icheckbox_flat-green'});n.find('form input:checkbox').on('ifChanged',function(){i()});a.initDatepickers(n.find('input.datepicker:first').parent(),n.find('input.datepicker:last').parent(),i);n.find('form#filter-transport').find('input:not(.datepicker), select').on('change',function(){i()});t.find('a[role=tab][aria-controls=tab-transport]').on('shown.bs.tab',function(){i()});n.on('click','button.btn-select-service',function(){var i=e(this).data('service'),r=t.data('item');a.translateResults(r,{'model':'transport','startAt':n.find('input.datepicker:first').val()+' 08:00','endAt':n.find('input.datepicker:last').val()+' 08:00','name':i.name,'supplier':i.supplier.id,'cost':i.cost,'totalPrice':i.totalPrice});r.find('[name$="[supplier]"]').trigger('change.select2');r.find('[name$="[totalPrice]"]').trigger('change');t.modal('hide')})},s=function(){t.find('.tab-content .tab-pane:not(#tab-hotel, #tab-private-house, #tab-car-rental, #tab-transport)').each(function(){var n=e(this),i=n.attr('id').replace(/^tab\-/,''),r=function(){var e={'model':i,'from':n.find('input.datepicker:first').val(),'to':n.find('input.datepicker:last').val(),'quantity':n.find('select[name=quantity]').val()};n.find('.table-responsive.results').empty().text(Translator.trans('Loading services...')).load(Routing.generate('app_offers_getgeneralserviceprices'),e,function(){n.find('.table-responsive.results table').DataTable({})})};a.initDatepickers(n.find('.date:has(.datepicker):first'),n.find('.date:has(.datepicker):last'),r);n.find('form').find('select, input:not(.datepicker)').on('change',function(){r()});n.on('click','button.btn-select-service',function(){var r=e(this).data('service'),o=t.data('item');t.modal('hide');a.translateResults(o,{'model':i,'startAt':n.find('input.datepicker:first').val(),'endAt':n.find('input.datepicker:last').val(),'name':r.serviceName,'supplier':r.supplier.id,'pax':r.pax,'cost':r.cost,'totalPrice':r.totalPrice});o.find('[name$="[supplier]"]').trigger('change.select2');o.find('[name$="[totalPrice]"]').trigger('change')});t.find('a[role=tab][aria-controls=tab-'+i+']').on('show.bs.tab',function(){r()})})};n();i();r();o();s();+(function(){var e=t.data('item').find('select[name$="[model]"]').val();t.find('.nav.nav-tabs a[href="#tab-'+e+'"]').tab('show')}())};return{init:function(){a=e('body');n();r();o()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Bookings=typeof App.Bookings!=='undefined'?App.Bookings:{};+(App.Bookings.Index=function(t){var a=t('#datatable-offers'),e=function(){var e=function(e){e.preventDefault();var r=t(this),n=r.attr('href');swal({title:Translator.trans('Confirm operation'),text:Translator.trans('The record will be cancelled. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(e){if(e){r.closest('td').text(Translator.trans('Updating...')).closest('tr').addClass('row-removing');t.ajax(n,{dataType:'json',method:'post',success:function(t){a.dataTable().api().draw(!1)}})}})},r=function(e){e.preventDefault();var r=t(this),n=r.attr('href');r.closest('td').text(Translator.trans('Updating...')).closest('tr').addClass('row-removing');t.ajax(n,{'dataType':'json','method':'POST','success':function(t){a.dataTable().api().draw(!1)}})},n=function(e){e.preventDefault();var r=t(this).attr('href'),n=t(this);swal({title:Translator.trans('Confirm removal'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(e){if(e){if(confirm('Are you sure you want to continue with removal?')){n.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');t.ajax(r,{dataType:'json',method:'post',success:function(t){a.find('tr.row-removing').remove();a.dataTable().api().draw(!1)}})}}})},o=function(e){e.preventDefault();var r=t(this).attr('href'),n=t(this);swal({title:Translator.trans('Confirm move'),text:Translator.trans('The record will be moved to the official operation. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#337ab7'},function(e){if(e){n.closest('td').text(Translator.trans('Moving...')).closest('tr').addClass('row-promoting');t.ajax(r,{dataType:'json',method:'post',success:function(t){a.find('tr.row-promoting').remove();a.dataTable().api().draw(!1)}})}})},i=function(e){e.preventDefault();var r=t(this).attr('href'),n=t(this);swal({title:Translator.trans('Confirm move'),text:Translator.trans('The record will be pulled off from the operation. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#337ab7'},function(e){if(e){n.closest('td').text(Translator.trans('Moving...')).closest('tr').addClass('row-promoting');t.ajax(r,{'dataType':'json','method':'POST','success':function(t){a.find('tr.row-promoting').remove();a.dataTable().api().draw(!1)}})}})};a.on('click','a.btn-promote',o);a.on('click','a.btn-unpromote',i);a.on('click','a.btn-delete',n);a.on('click','a.btn-cancel',e);a.on('click','a.btn-uncancel',r);a.dataTable({order:[[4,'asc']],columnDefs:[{'searchable':!1,'sortable':!1,'targets':[5],'width':'158px','title':Translator.trans('Actions')},{'name':'version','searchable':!1,'sortable':!1,'targets':[0],'title':'V','width':'20px'},{'name':'state','searchable':!1,'targets':[1],'title':Translator.trans('State'),'width':'35px'},{'name':'name','targets':[2],'title':Translator.trans('Name')},{'name':'client','targets':[3],'title':Translator.trans('Client')},{'name':'startAt','searchable':!1,'targets':[4],'title':Translator.trans('Date')}],processing:!0,serverSide:!0,ajax:{method:'post',url:Routing.generate('app_offers_getdata'),data:function(a){var e=[];t.each(t('form#filter').serializeArray(),function(t,a){e[a['name']]=a['value']});return t.extend(!0,a,e)}}})},r=function(){t('form#filter input[name="booking_list_filter_form[startAt][left_date]"]').parent().datetimepicker({format:'DD/MM/YYYY',showClear:!0});t('form#filter input[name="booking_list_filter_form[startAt][right_date]"]').parent().datetimepicker({format:'D/MM/YYYY',useCurrent:!1,showClear:!0});t('form#filter input[name="booking_list_filter_form[startAt][left_date]"]').parent().on('dp.change',function(e){t('form#filter input[name="booking_list_filter_form[startAt][right_date]"]').parent().data('DateTimePicker').minDate(e.date);a.DataTable().draw()});t('form#filter input[name="booking_list_filter_form[startAt][right_date]"]').parent().on('dp.change',function(e){t('form#filter input[name="booking_list_filter_form[startAt][left_date]"]').parent().data('DateTimePicker').maxDate(e.date);a.DataTable().draw()});t('form#filter select').on('change',function(){a.DataTable().draw()})};return{init:function(){e();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Clients=typeof App.Clients!=='undefined'?App.Clients:{};+(App.Clients.Index=function(t){var e=function(){var e=t('#datatable-clients');e.dataTable({'order':[[0,'asc']],'columnDefs':[{orderable:!1,sortable:!1,targets:[1]},{name:'fullname',targets:[0]}],'dom':'lfrtip','processing':!0,'serverSide':!0,'ajax':{'method':'POST','url':Routing.generate('app_clients_getdata')}});e.on('draw.dt',function(){t(this).find('a.btn-delete').on('click',function(n){n.preventDefault();var a=t(this).attr('href'),r=t(this);swal({title:Translator.trans('Confirm remove'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(n){if(n){r.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');t.ajax(a,{dataType:'json',method:'post',success:function(t){e.find('tr.row-removing').remove();swal({title:Translator.trans('Notification'),text:Translator.trans('Client has been removed successfuly')});e.dataTable().api().draw(!1)}})}})})})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Contracts=typeof App.Contracts!=='undefined'?App.Contracts:{};+(App.Contracts.Form=function(t){var e=function(){var e=function(e){if(!t(e).is(':visible')){e=t(e).parent()};return t(e)},n=function(t,e){if(!t.data('tooltipster-ns')){t.tooltipster({'trigger':'custom','onlyOne':!1,'position':'bottom-left','positionTracker':!0})};t.tooltipster('update',e);t.tooltipster('show')};t.validator.addClassRules('item-counter',{min:1});t('#contract').validate({errorPlacement:function(i,a){a=e(a);n(a,t(i).text())},ignore:':hidden:not(.item-counter)',rules:{'contract_form[startAt]':{required:{depends:function(){return''!==t('#contract_form_endAt').val()}}},'contract_form[endAt]':{required:{depends:function(){return''!==t('#contract_form_startAt').val()}}},'carRentalCategoriesLength':{min:{param:1,depends:function(){return t('select#contract_form_model').val()=='car-rental'}}},'carRentalSeassonsLength':{min:{param:1,depends:function(){return t('select#contract_form_model').val()=='car-rental'}}}},messages:{'carRentalCategoriesLength':{min:'Car rental contract needs categories'},'carRentalSeassonsLength':{min:'Car rental contract needs seasson'}},success:function(n,i){i=e(i);t(i).tooltipster('hide')}})},n=function(){t('#contract_form_model').on('change',function(){var e=t(this).val();t('.visible-condition').each(function(){if(t(this).hasClass('visible-condition-'+e)){t(this).show()}
else{t(this).hide();t(this).find('.collection:first').data('index',0).empty()}});t('.hiddeable-condition').each(function(){if(t(this).hasClass('hiddeable-condition-'+e)){t(this).hide()}
else{t(this).show()}});t('.visible-condition-only').each(function(){if(t(this).hasClass('visible-condition-only-'+e)){t(this).show()}
else{t(this).hide()}})});t('#contract_form_signedAt').parent().datetimepicker({format:'DD/MM/YYYY'});t('#contract_form_startAt').parent().datetimepicker({format:'DD/MM/YYYY'});t('#contract_form_endAt').parent().datetimepicker({useCurrent:!1,format:'DD/MM/YYYY'});t('#contract_form_startAt').parent().on('dp.change',function(e){t('#contract_form_endAt').parent().data('DateTimePicker').minDate(e.date)});t('#contract_form_endAt').parent().on('dp.change',function(e){t('#contract_form_startAt').parent().data('DateTimePicker').maxDate(e.date)});t('.item-top-service').each(function(){var e=t(this).find('.datetimepicker');t(e[0]).datetimepicker({format:'DD/MM/YYYY HH:mm'});t(e[1]).datetimepicker({format:'DD/MM/YYYY HH:mm',useCurrent:!1});t(e[0]).on('dp.change',function(n){t(e[1]).data('DateTimePicker').minDate(n.date)});t(e[1]).on('dp.change',function(n){t(e[0]).data('DateTimePicker').maxDate(n.date)})})},i=function(){+(function(){var n=function(t){t.find('.date:has(.datepicker):first').datetimepicker({format:'DD/MM/YYYY'});t.find('.date:has(.datepicker):last').datetimepicker({format:'DD/MM/YYYY',useCurrent:!1});t.find('.date:has(.datepicker):first').on('dp.change',function(e){t.find('.date:has(.datepicker):last').data('DateTimePicker').minDate(e.date)});t.find('.date:has(.datepicker):last').on('dp.change',function(e){t.find('.date:has(.datepicker):first').data('DateTimePicker').maxDate(e.date)})},i=function(e){e.preventDefault();var n=t(this).closest('.item'),i=n.closest('.collection');n.fadeOut(function(){n.remove();if(i.data('counter')){t(i.data('counter')).val(i.find('>.item').length)}})},e=function(e){if(typeof e==='undefined'){e=t('body')};t(e).find('.collection').each(function(){var e=t(this);e.data('index',e.find('>.item').length)})},a=function(){var i=t(this).data('collection')?t(t(this).data('collection')):t(this).closest(':has(.collection)').find('.collection:first'),c=i.data('prototype'),o=i.data('index');if(i.hasClass('collection-facilities')){var a=t(c.replace(/facilities___name__/g,'facilities_'+o).replace(/facilities\]\[__name__/g,'facilities]['+o))}
else if(i.hasClass('collection-car-rental-seassons')){var a=t(c.replace(/carRentalSeassons___name__/g,'carRentalSeassons_'+o).replace(/carRentalSeassons\]\[__name__/g,'carRentalSeassons]['+o))}
else{var a=t(c.replace(/__name__/g,o))};i.data('index',o+1);i.append(a);if(i.data('counter')){t(i.data('counter')).val(i.find('>.item').length)};if(a.find('.collection').length>0){e(a)};n(a);t(a.find('input:text:visible, select:visible')[0]).focus()},o=function(n){var o=t(this).closest('.item'),c=o.closest('.collection'),i=c.data('index');$newItem=o.clone();o.closest('.collection').append($newItem);$newItem.find('[id][name]').each(function(){var e=t(this);if(/facilities_\d+_/.test(e.attr('id'))){var n=e.attr('id'),a=n.replace(/facilities_\d+/,'facilities_'+i);e.attr('id',a);t('label[for="'+n+'"]').attr('for',a);e.attr('name',e.attr('name').replace(/facilities\]\[\d+/,'facilities]['+i))}});var a=$newItem.find('.collection.collection-seasons');a.data('prototype',a.data('prototype').replace(/facilities_\d+/g,'facilities_'+i).replace(/facilities\]\[\d+/g,'facilities]['+i));console.log(a.data('prototype'));c.data('index',i+1);if($newItem.find('.collection').length>0){e($newItem)};$newItem.find('.input-daterange').each(function(){var e=t(this);e.datepicker({inputs:e.find('input:text').toArray()});e.find('input:text:first').on('change',function(){t(this).closest('.item').find('input:text:last').datepicker('setDate',t(this).val())})})};t('body').on('click','.btn-add-item',a);t('body').on('click','.btn-remove',i);t('body').on('click','.btn-clone-item',o);t('body').on('click','.btn-create-rest-seasons',function(){var d=t(this).parent().find('button.btn-add-item'),s=t(this).closest(':has(.collection)').find('.collection:first'),o=[];s.find('.item').each(function(){var e=t(this);o.push({'from':moment(e.find('input:text:first').val(),'DD/MM/YYYY',!0),'to':moment(e.find('input:text:last').val(),'DD/MM/YYYY',!0)})});var e=[],n=moment(t('#contract_form_startAt').val(),'DD/MM/YYYY',!0),l=moment(t('#contract_form_endAt').val(),'DD/MM/YYYY',!0),a=null,c;while(n.isBefore(l,'day')){c=!1;t.each(o,function(t){if(n.isSameOrAfter(o[t].from,'day')&&n.isSameOrBefore(o[t].to,'day')){if(null!==a){e.push({from:a.clone(),to:n.clone().subtract(1,'days')});a=null};n=o[t].to.clone();n.add(1,'days');c=!0;return!1}});if(!c){if(null===a){a=n.clone()};n.add(1,'days')}};if(null!==a){e.push({from:a.clone(),to:n.clone()})};if(e.length>0){for(var i=0;i<e.length;i++){d.trigger('click')};$items=s.find('.item');for(var i=$items.length-e.length;i<$items.length;i++){var r=t($items[i]);r.find('input:text:first').val(e[i-($items.length-e.length)].from.format('DD/MM/YYYY'));r.find('input:text:last').val(e[i-($items.length-e.length)].to.format('DD/MM/YYYY'))}}});e();t('.item-top-service, .item-facility-season, .item-private-house-service, .item-car-rental-seasson-date, .item-private-house-seasson').each(function(){n(t(this))})}())};return{init:function(){e();n();i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Contracts=typeof App.Contracts!=='undefined'?App.Contracts:{};+(App.Contracts.Index=function(t){var e=t('#datatable-x'),n=function(){e.dataTable({order:[[1,'asc']],searching:!1,columns:[{sortable:!1,},{name:'name'},{name:'model'},{name:'supplier'},{name:'signedAt'},{name:'startAt'},{name:'endAt'},{sortable:!1,width:'80px'}],serverSide:!0,processing:!0,ajax:{method:'POST',url:Routing.generate('app_contracts_getdata'),data:function(e){var n=[];t.each(t('form#filter').serializeArray(),function(t,e){n[e['name']]=e['value']});return t.extend({},e,n)}}});e.on('draw.dt',function(){t(this).find('input').iCheck({'checkboxClass':'icheckbox_flat-green'})});e.on('click','a.btn-delete',function(n){n.preventDefault();var a=t(this).attr('href'),r=t(this);swal({title:Translator.trans('Confirm remove'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(n){if(n){r.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');t.ajax(a,{dataType:'json',method:'post',success:function(t){e.find('tr.row-removing').remove();e.dataTable().api().draw(!1)}})}})})},a=function(){t('#filter select').on('change',function(){e.DataTable().draw(!0)});t('#filter input:text').on('keyup',function(){e.DataTable().draw(!0)})};return{init:function(){n();a()}}}(jQuery));
(function(e,t){var n=function(e,n,i){var t;return function(){var c=this,a=arguments;function o(){if(!i)e.apply(c,a);t=null};if(t)clearTimeout(t);else if(i)e.apply(c,a);t=setTimeout(o,n||100)}};jQuery.fn[t]=function(e){return e?this.bind("resize",n(e)):this.trigger(t)}})(jQuery,"smartresize");var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");$(document).ready(function(){var e=function(){$RIGHT_COL.css("min-height",$(window).height());var e=$BODY.outerHeight(),i=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),t=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),n=e<t?t:e;n-=$NAV_MENU.height()+i;$RIGHT_COL.css("min-height",n)};$SIDEBAR_MENU.find("a").on("click",function(t){var n=$(this).parent();if(n.is(".active")){n.removeClass("active active-sm");$("ul:first",n).slideUp(function(){e()})}
else{if(!n.parent().is(".child_menu")){$SIDEBAR_MENU.find("li").removeClass("active active-sm");$SIDEBAR_MENU.find("li ul").slideUp()};n.addClass("active");$("ul:first",n).slideDown(function(){e()})}});$MENU_TOGGLE.on("click",function(){if($BODY.hasClass("nav-md")){$SIDEBAR_MENU.find("li.active ul").hide();$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")}
else{$SIDEBAR_MENU.find("li.active-sm ul").show();$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")};$BODY.toggleClass("nav-md nav-sm");e()});$SIDEBAR_MENU.find("a[href*=\""+CURRENT_URL+"\"]:first").parent("li").addClass("current-page");$SIDEBAR_MENU.find("a").filter(function(){return this.href!==""&&CURRENT_URL.search(this.href)!==-1}).parent("li").addClass("current-page").parents("ul").slideDown(function(){e()}).parent().addClass("active");$(window).smartresize(function(){e()});e();if($.fn.mCustomScrollbar){$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}});$(document).ready(function(){$("body").on("click",".collapse-link",function(){var e=$(this).closest(".x_panel"),n=$(this).find("i"),t=e.find(".x_content");if(e.css("style")){t.slideToggle(200,function(){e.removeAttr("style")})}
else{t.slideToggle(200);e.css("height","auto")};n.toggleClass("fa-chevron-up fa-chevron-down")});$(".close-link").click(function(){var e=$(this).closest(".x_panel");e.remove()})});$(document).ready(function(){$("[data-toggle=\"tooltip\"]").tooltip({container:"body"})});if($(".progress .progress-bar")[0]){$(".progress .progress-bar").progressbar()};$(document).ready(function(){if($(".js-switch")[0]){var e=Array.prototype.slice.call(document.querySelectorAll(".js-switch"));e.forEach(function(e){var t=new Switchery(e,{color:"#26B99A"})})}});$("table input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$("table input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});var checkState="";$(".bulk_action input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$(".bulk_action input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});$(".bulk_action input#check-all").on("ifChecked",function(){checkState="all";countChecked()});$(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none";countChecked()});function countChecked(){if(checkState==="all"){$(".bulk_action input[name='table_records']").iCheck("check")};if(checkState==="none"){$(".bulk_action input[name='table_records']").iCheck("uncheck")};var e=$(".bulk_action input[name='table_records']:checked").length;if(e){$(".column-title").hide();$(".bulk-actions").show();$(".action-cnt").html(e+" Records Selected")}
else{$(".column-title").show();$(".bulk-actions").hide()}};$(document).ready(function(){$(".expand").on("click",function(){$(this).next().slideToggle(200);$expand=$(this).find(">:first-child");if($expand.text()=="+"){$expand.text("-")}
else{$expand.text("+")}})});if(typeof NProgress!="undefined"){NProgress.start();$(document).ready(function(){NProgress.done();$(document).bind("ajaxSend",function(e,t){NProgress.promise(t.promise())})})};
;App=typeof App!=='undefined'?App:{};App.ReceivableAccounts=typeof App.ReceivableAccounts!=='undefined'?App.ReceivableAccounts:{};+(App.ReceivableAccounts.Index=function(a){var e=function(){var e=a('#datatable-x');e.on('click','.btn-change-state',function(n){n.preventDefault();var t=a('.modal#modal-change');t.data('process',a(this));a(this).attr('disabled','disabled');t.modal();t.find('.modal-content').empty().append(a('<div class="modal-body"><p>'+Translator.trans('Loading data...')+'</p></div>')).load(a(this).attr('href'),function(){t.data('process').removeAttr('disabled');t.find('form').ajaxForm({'dataType':'json',success:function(n){t.modal('hide');a(t.data('process')).parent().text(Translator.trans('Updating...'));e.dataTable().api().draw(!1)}});var n=t.find('.collection');n.data('index',n.find('.item').length);t.find('.btn-add-item').on('click',function(){var e=t.find('.collection'),d=e.data('prototype'),n=e.data('index');$item=a(d.replace(/__name__/g,n)).appendTo(e);e.data('index',n+1)})})});e.on('click','.btn-view',function(e){e.preventDefault();var t=a('.modal#modal-view'),n=a(this).data('cancel-url');t.modal();t.find('.modal-content').empty().load(a(this).attr('href'),function(){t.find('a.btn-danger').attr('href',n)})});e.dataTable({'order':[[2,'desc']],'aoColumns':[{'name':'client'},{'name':'name'},{'name':'startAt',searchable:!1},{'name':'endAt',searchable:!1},{'name':'price',searchable:!1},{'name':'date'},{'name':'notes'},{sortable:!1,searchable:!1}],'serverSide':!0,'processing':!0,ajax:{'method':'POST','url':Routing.generate('app_cxcobrar_getdata'),'data':function(e){return a.extend({},e,{'filter':{'state':a('form#filter select[name$="[state]"]').val()}})}}});a('form#filter select').on('change',function(){e.dataTable().api().draw(!0)})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.PayableAccounts=typeof App.PayableAccounts!=='undefined'?App.PayableAccounts:{};+(App.PayableAccounts.Index=function(a){var e=function(){var e=a('#datatable-x');e.on('click','.btn-change-state',function(n){n.preventDefault();var t=a('.modal#modal-change');t.find('.modal-content').empty().load(a(this).attr('href'),function(){t.find('form').ajaxForm({beforeSubmit:function(){t.find('button[type=submit]').text(Translator.trans('Saving...')).attr('disabled','disabled')},dataType:'json',success:function(a){t.modal('hide');e.dataTable().api().draw(!0)}});var n=t.find('.collection');n.data('index',n.find('.item').length);t.find('.btn-add-item').on('click',function(){var e=n.data('index'),t=n.data('prototype');n.append(a(t.replace(/__name__/g,e)));n.data('index',e+1)})});t.modal()});e.on('click','.btn-view',function(e){e.preventDefault();var t=a('.modal#modal-view');t.modal();t.find('.modal-content').empty().load(a(this).attr('href'))});a('.modal#modal-change button.btn-primary').on('click',function(){a(this).attr('disabled','disabled').text(Translator.trans('Saving...'));a.ajax(a('.modal#modal-change').data('record-url'),{data:{notes:a('.modal#modal-change textarea').val()},dataType:'json',method:'POST',success:function(t){e.dataTable().api().draw(!1);swal({title:Translator.trans('Success'),text:Translator.trans('Operation done successfuly.')});a('.modal#modal-change').modal('hide')}})});e.dataTable({order:[[3,'asc']],aoColumns:[{name:'client'},{name:'name'},{name:'service'},{name:'startAt',searchable:!1},{name:'endAt',searchable:!1},{name:'supplier'},{name:'date',searchable:!1},{name:'notes'},{sortable:!1,searchable:!1}],serverSide:!0,processing:!0,ajax:{method:'post',url:Routing.generate('app_cxpagar_getdata'),data:function(e){return a.extend({},e,{filter:{state:a('form#filter select[name$="[state]"]').val()}})}}});a('form#filter select').on('change',function(){e.dataTable().api().draw(!0)})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.CarRentalPrices=typeof App.CarRentalPrices!=='undefined'?App.CarRentalPrices:{};+(App.CarRentalPrices.Form=function(a){'use strict';var t=function(){a('body').on('change','input.updatable-ajax',function(){var t=a(this);if(t.data('saving')){t.data('saving').xhr.abort()};var e=Date.now(),i=t.data('params'),p=i.split('|'),n={inputId:e,value:t.val()};a.each(p,function(a,e){var t=e.split('=');n[t[0]]=t[1]});t.css({borderColor:'red'}).attr({'ajax-id':e});var r={xhr:a.ajax(Routing.generate('app_contracts_setcarrentalprice'),{data:n,dataType:'json',method:'POST',success:function(t){a('input.updatable-ajax[ajax-id='+t.inputId+']').val(t.value).css({borderColor:''}).removeAttr('ajax-id').removeData('saving')}})};t.data('saving',r)})};return{init:function(){t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Clients=typeof App.Clients!=='undefined'?App.Clients:{};+(App.Clients.Form=function(t){var n=function(){+(function(){t('.collection').each(function(){var n=t(this),e=n.find('> .item').length;n.data('index',e)});t('body').on('click','.btn-add-item',function(n){n.preventDefault();var e=t(this).parent().parent().find('.collection'),p=e.data('prototype'),o=e.data('index'),i=t(p.replace(/__name__/g,o));e.append(i);i.find('input:text:first').focus();e.data('index',o+1);t('input:hidden[name="contactCounter"]').val(t('#client_form_contacts').find('.item').length);App.Forms.initTelephoneControl(i.find('input[type=tel]'))});t('body').on('click','.btn-delete-item',function(n){n.preventDefault();t(this).closest('.item').fadeOut(function(){t(this).remove();t('input:hidden[name="contactCounter"]').val($container.find('.item').length)})})}());App.Forms.initTelephoneControl(t('input[type=tel]'));t('form#client').validate({errorPlacement:function(e,n){if(n.is(':hidden')){n=n.closest(':visible')};if(!n.data('tooltipster-ns')){n.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};n.tooltipster('update',t(e).text());n.tooltipster('show')},messages:{'contactCounter':{min:Translator.trans('Client has no contact person')}},rules:{'contactCounter':{min:1}},ignore:':hidden:not(input[name=contactCounter])',success:function(e,n){if(t(n).is(':hidden')){n=t(n).closest(':visible')};t(n).tooltipster('hide')}})};return{init:function(){n()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.HotelPrices=typeof App.HotelPrices!=='undefined'?App.HotelPrices:{};+(App.HotelPrices.Form=function(a){'use strict';var t=function(){a('body').on('change','input.updatable-ajax',function(){var t=a(this);if(t.data('saving')){t.data('saving').xhr.abort()};var e=Date.now(),r=t.data('params'),s=r.split('|'),n={inputId:e,value:t.val()};a.each(s,function(a,e){var t=e.split(':');n[t[0]]=t[1]});t.css({borderColor:'red'}).attr({'ajax-id':e});var i={xhr:a.ajax(Routing.generate('app_contracts_sethotelprice'),{data:n,dataType:'json',method:'POST',success:function(t){a('input:text.updatable-ajax[ajax-id='+t.inputId+']').val(t.value).css({borderColor:''}).removeAttr('ajax-id').removeData('saving')}})};t.data('saving',i)})},e=function(){a('body').on('click','a.copy-prices',function(t){t.preventDefault();var e=a(this).closest('table'),n=a(this).data('from'),i=new RegExp('season:'+a(this).data('to')+'\\|');e.find('input:text').filter(function(){return a(this).data('params')&&i.test(a(this).data('params'))}).each(function(){var t=a(this),i=t.data('params').replace(/season:(\d+)\|/,'season:'+n+'|');t.val(e.find('input[data-params="'+i+'"]').val()).trigger('change')})})};return{init:function(){t();e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Places=typeof App.Places!=='undefined'?App.Places:{};+(App.Places.Form=function(t){var e=function(){t('form#place').validate({errorPlacement:function(o,e){if(!e.data('tooltipster-ns')){e.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};e.tooltipster('update',t(o).text());e.tooltipster('show')},success:function(e,o){t(o).tooltipster('hide')}})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Profile=typeof App.Profile!=='undefined'?App.Profile:{};+(App.Profile.Form=function(e){var t=function(){App.Forms.initTelephoneControl(e('input[type=tel]'));e.validator.addMethod('strongpassword',function(e,t){return this.optional(t)||(/[A-Z]/.test(e)&&/[a-z]/.test(e)&&/[0-9]/.test(e)&&e.length>7)},Translator.trans('Password strong is too low (8 characters minimun and contains at least 1 character from groups [A-Z], [a-z] and [0-9])'));e('form#profile').validate({errorPlacement:function(o,t){if(!t.data('tooltipster-ns')){t.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};t.tooltipster('update',e(o).text());t.tooltipster('show')},success:function(t,o){e(o).tooltipster('hide')}});e('.fileupload').on('change','input:file',function(o,t){if(typeof t!=='undefined'&&t.indexOf('clear')!==-1&&e(this).closest('.fileupload').find('input:checkbox[name="fos_user_profile_form[imageFile][delete]"]').length>0){e(this).closest('.fileupload').find('input:checkbox[name="fos_user_profile_form[imageFile][delete]"]').prop('checked',!0)}})};return{init:function(){t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.RentCarTypes=typeof App.RentCarTypes!=='undefined'?App.RentCarTypes:{};+(App.RentCarTypes.Form=function(t){var e=function(){t('#car').validate({errorPlacement:function(o,e){if(!e.data('tooltipster-ns')){e.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};e.tooltipster('update',t(o).text());e.tooltipster('show')},success:function(e,o){t(o).tooltipster('hide')}})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Suppliers=typeof App.Suppliers!=='undefined'?App.Suppliers:{};+(App.Suppliers.Form=function(e){'use strict';var t=function(){var t=e('#supplier_form_employees');t.data('index',t.find('> .item').length);e('#btnAddEmployee').on('click',function(n){n.preventDefault();var i=t.data('index'),p=t.data('prototype'),o=e(p.replace(/form_employees___name___/g,'form_employees_'+i+'_').replace(/employees\]\[__name__\]/g,'employees]['+i+']'));t.append(o);App.Forms.initTelephoneControl(o.find('input[type=tel]'),{preferredCountries:['cu']});o.find('.collection-emails').data('index',0);t.data('index',i+1)});e('.collection-emails').each(function(){e(this).data('index',e(this).find('.item').length)});t.on('click','.btn-add-email',function(t){t.preventDefault();var n=e(this).closest('.row').find('.collection-emails'),i=n.data('index'),o=n.data('prototype'),p=e(o.replace(/__name__/g,i));n.append(p);n.data('index',i+1)});t.on('click','.btn-remove-item',function(t){t.preventDefault();console.log(e(this).parents());e(this).closest('.item').fadeOut(function(){e(this).remove()})})},n=function(){App.Forms.initTelephoneControl(e('form#supplier input[type=tel]'),{preferredCountries:['cu']});e('form#supplier select[name$="[place]"]').select2({width:'100%',minimunInputLength:1,ajax:{url:Routing.generate('app_suppliers_getplaces'),dataType:'json',delay:250,method:'GET',processResults:function(e){var t=e.data;t.unshift({id:0,text:''});return{results:t}}}})},i=function(){e('#supplier').validate({errorPlacement:function(t,n){if(!n.data('tooltipster-ns')){n.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};n.tooltipster('update',e(t).text());n.tooltipster('show')},success:function(t,n){e(n).tooltipster('hide')}})};return{init:function(){n();i();t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Users=typeof App.Users!=='undefined'?App.Users:{};+(App.Users.Form=function(t){var o=function(){App.Forms.initTelephoneControl(t('input[type=tel]'));t.validator.addMethod('strongpassword',function(t,o){return this.optional(o)||(/[A-Z]/.test(t)&&/[a-z]/.test(t)&&/[0-9]/.test(t)&&t.length>7)},Translator.trans('Password strong is too low (8 characters minimun and contains at least 1 character from groups [A-Z], [a-z] and [0-9])'));t('#user').validate({rules:{'{{ form.plainPassword.first.vars.full_name }}':'strongpassword','{{ form.plainPassword.second.vars.full_name }}':{'equalTo':'#{{ form.plainPassword.first.vars.id }}'}},errorPlacement:function(s,o){if(!o.data('tooltipster-ns')){o.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};o.tooltipster('update',t(s).text());o.tooltipster('show')},success:function(o,s){t(s).tooltipster('hide')}})};return{init:function(){o()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Notifications=typeof App.Notifications!=='undefined'?App.Notifications:{};+(App.Notifications.Index=function(a){var e=a('#datatable-x'),t=function(){e.on('click','.btn-change-state',function(t){t.preventDefault();a(this).attr('disabled','disabled');a('#modalConfirm').data('process',a(this));a('#modalConfirm .modal-content').load(a(this).attr('href'),function(){a('#modalConfirm').modal();e.find('.btn[disabled]').removeAttr('disabled');a('#modalConfirm form').ajaxForm({beforeSuccess:function(){a('#modalConfirm button.btn-primary').attr('disabled','disabled')},success:function(t){a('#modalConfirm').modal('hide');a(a('#modalConfirm').data('process')).parent().text(Translator.trans('Updating...'));a('#modalConfirm').removeData('process');e.dataTable().api().draw(!0)}})})});e.dataTable({order:[[5,'asc']],aoColumns:[{name:'name'},{name:'operator'},{name:'client'},{name:'supplier'},{name:'service'},{name:'startAt',searchable:!1},{name:'endAt',searchable:!1},{name:'reference'},{sortable:!1,searchable:!1}],processing:!0,serverSide:!0,ajax:{method:'post',url:Routing.generate('app_notifications_getdata'),data:function(e){var t=[];a.each(a('form#filter').serializeArray(),function(a,e){t[e['name']]=e['value']});return a.extend({},e,t)}}})},n=function(){a('form#filter select').on('change',function(){e.dataTable().api().draw()})};return{init:function(){t();n()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Places=typeof App.Places!=='undefined'?App.Places:{};+(App.Places.Index=function(t){var e=function(){var e=t('#datatable-x');e.dataTable({'columns':[{'name':'name','title':Translator.trans('Name')},{'name':'postalAddress','title':Translator.trans('Postal address')},{'name':'province','title':Translator.trans('Province')},{'title':Translator.trans('Actions'),'orderable':!1,'sortable':!1,'width':'80px'}],'serverSide':!0,'processing':!0,'ajax':{'method':'POST','url':Routing.generate('app_places_getdata')},'oSearch':{'sSearch':e.data('search')}});e.on('draw.dt',function(){t(this).find('a.btn-delete').on('click',function(a){a.preventDefault();var n=t(this).attr('href'),r=t(this);swal({title:Translator.trans('Confirm remove'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(a){if(a){r.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');t.ajax(n,{dataType:'json',method:'post',success:function(t){e.find('tr.row-removing').remove();e.dataTable().api().draw(!1)}})}})})})};return{init:function(){e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};+(App.PrivateHousePrices=function(t){'use strict';var i=function(){t('a.link-edit-notes').on('click',function(o){o.preventDefault();var n=t('input:text[data-params="'+t(this).data('params')+'"]'),i=t(this).closest('tr').find('.modal'),a=t(this).attr('href');i.find('.modal-body').empty();i.find('.modal-footer button.btn-primary').hide();if((t.trim(n.val())==='')||!t.isNumeric(n.val())){swal({title:'Notes without price',text:'You must set a price for this record before write notes',type:'warning'});return};i.data('url',a);i.modal()});t('.modal-notes').on('shown.bs.modal',function(){var i=t(this);i.find('.modal-body').load(t(this).data('url'),function(){i.find('.modal-footer button.btn-primary').fadeIn()}).block({message:Translator.trans('Loading data...')})});t('button.btn-submit-note').on('click',function(){t(this).attr('disabled','disabled');t(this).closest('form').submit()});t('.modal-notes form').each(function(){var i=t(this);t(this).ajaxForm({target:i.find('.modal-body'),success:function(){i.find('button.btn-primary').removeAttr('disabled')}})})};return{init:function(){i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.RentCarTypes=typeof App.RentCarTypes!=='undefined'?App.RentCarTypes:{};+(App.RentCarTypes.Index=function(e){var t=function(){var t=e('#datatable-x');t.dataTable({'columnDefs':[{orderable:!1,sortable:!1,targets:[1]},{name:'name',targets:[0]}],processing:!0});t.find('a.btn-delete').on('click',function(n){n.preventDefault();var r=e(this).attr('href'),o=e(this);swal({title:Translator.trans('Confirm remove'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(n){if(n){o.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');e.ajax(r,{dataType:'json',method:'post',success:function(e){t.find('tr.row-removing').remove();location.href=location.href}})}})})};return{init:function(){t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Suppliers=typeof App.Suppliers!=='undefined'?App.Suppliers:{};+(App.Suppliers.Index=function(e){var t=function(){var t=e('#datatable-suppliers');t.dataTable({'columnDefs':[{'orderable':!1,'sortable':!1,'targets':[2],'title':Translator.trans('Actions'),'width':'80px'},{'name':'name','targets':[0],'title':Translator.trans('Name')},{'name':'fixedPhone','targets':[1],'title':Translator.trans('Fixed phone'),'searchable':!1,'sortable':!1}],'serverSide':!0,'processing':!0,ajax:{'method':'POST','url':Routing.generate('app_suppliers_getdata')}});t.on('draw.dt',function(){e(this).find('a.btn-delete').on('click',function(r){r.preventDefault();var a=e(this).attr('href'),n=e(this);swal({'title':Translator.trans('Confirm remove'),'text':Translator.trans('The record will be removed. Are you sure you want to continue?'),'type':'warning','showCancelButton':!0,'confirmButtonColor':'#d9534f'},function(r){if(r){n.closest('td').text(Translator.trans('Removing...')).closest('tr').addClass('row-removing');e.ajax(a,{'dataType':'json','method':'POST','success':function(e){t.find('tr.row-removing').remove();t.dataTable().api().draw(!1)}})}})})})};return{init:function(){t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Users=typeof App.Users!=='undefined'?App.Users:{};+(App.Users.Index=function(e){var n=function(){var n=e('#datatable-users');n.dataTable({'order':[[1,'asc']],'columnDefs':[{'orderable':!1,'targets':[0,3]}],'processing':!0});n.on('draw.dt',function(){e(this).find('input').iCheck({'checkboxClass':'icheckbox_flat-green'})});e('.btn-delete').on('click',function(n){n.preventDefault();var t=e(this).attr('href');swal({title:Translator.trans('Confirm remove'),text:Translator.trans('The record will be removed. Are you sure you want to continue?'),type:'warning',showCancelButton:!0,confirmButtonColor:'#d9534f'},function(e){if(e){location.href=t}})})};return{init:function(){n()}}}(jQuery));